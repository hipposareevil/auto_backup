
# like git rev-parse for our backup strategy
_find_source_root() {
    what_to_find=".backup.directory"

    path=$PWD
    while [[ "$path" != "" && ! -e "$path/$what_to_find" ]]; do
        path=${path%/*}
    done
    echo "$path"
}


# If directory is under backup control, add a thumbs up or down
prompt_backup() {
    real_root=$(_find_source_root)
    if [ ! -z "$real_root" ]; then
        # find pid file
        pid_file=${real_root}/.backup.directory/.pid
        if [ -e $pid_file ]; then
            pid=$(cat $pid_file)
            result=$(ps -elf | grep $pid | grep -v grep | wc -l)
            return_code=$?

            if [ $result -eq 0 ]; then
                # backup not running
                echo -n " ğŸ‘"
            else
                # backup running
                # thumbs up
                echo -n " ğŸ‘"
            fi

        else
            echo -n " ğŸ‘"
        fi
    fi
}